<% content_for :head do %>
  <script type="text/javascript">
    $(document).ready(function() {
      $(".user_hoverer").each(function(i, ob) {
        $(ob).qtip({
          style: { name: 'cream', tip: true }, 
          position: {
            corner: {
               target: 'topMiddle',
               tooltip: 'bottomMiddle'
            }
          }, 
          content: generate_overview_table()
        });
      });
    });
    
    function generate_overview_table() {
      var stringeske = "<table><tbody>";
      $(".quantity_field[value!='']").each(function(i, ob){
        stringeske += "<tr><td>" + $("#" + $(ob).attr("td_id")).html() + "</td><td style='text-align: right;'>" + $(ob).val() + " * " + parseFloat($(ob).attr("price")) + " = " + (parseInt($(ob).val())*parseFloat($(ob).attr("price"))).toFixed(2) + "</td></tr>";
      });
      stringeske += "</tbody></table>"
      return stringeske;
    }
  </script>
<% end %>

<h1>Security Rights</h1>
<div id="searchwrapper">
  <%= will_paginate @rights, :params => params %>
  <table class="showtable">
    <tbody class="table_header">
      <td class="header_cell">Right</td>
      <td class="header_cell">Users</td>
    </tbody>
    <tbody class="button_row">
      <td colspan="4" class="header_cell"><%= new_link :url => new_user_right_path %></td>
    </tbody>
    <% @rights.each do |right| %>
      <tbody class="<%= cycle("even","odd") %>">
        <td>
          <%= right.rights_key %>
        </td>
        <td style="text-align: center;">
          <span class="user_hoverer" users="<%= User.find(:all, ) %>">Hover for users</span>
        </td>
        <td class="button_cell"><%= destroy_link :url => delete_rights_user_rights_path(:key => right.rights_key) %></td>
      </tbody>
    <% end %>
  </table>
</div>